<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SDEV200: Prepared Statements</title>
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./../assets/images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="./../assets/images/favicon-16x16.png"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400;0,700;1,400;1,700&family=Roboto:ital,wght@0,400;0,700;1,400;1,700&display=swap"
      rel="stylesheet"
    />
    <script src="./../assets/scripts/code_snippets.js" defer></script>
    <script src="./../assets/scripts/focus_content.js" defer></script>
    <script src="./../assets/scripts/table_of_contents.js" defer></script>

    <!-- Bootstrap / Sass -->
    <link rel="stylesheet" href="./../assets/css/styles.css" />
    <link rel="stylesheet" href="./../assets/css/bootstrap-icons.css" />
    <script src="./../assets/scripts/bootstrap.bundle.min.js" defer></script>
  </head>
  <body class="bg-light">
    <div class="content-wrapper">
      <div class="toc">
        <ul>
          <li>
            <a href="#prepared-statements">Prepared Statements</a>
            <ul>
              <li><a href="#example">Example</a></li>
              <li><a href="#sql-injection">SQL Injection</a></li>
              <li><a href="#naive-implementation">Naive Implementation</a></li>
              <li><a href="#prepared-statements-1">Prepared Statements</a></li>
            </ul>
          </li>
        </ul>
      </div>

      <h1 id="prepared-statements">Prepared Statements</h1>
      <p>
        <strong>Prepared Statements</strong> are a way to execute SQL statements
        with parameters.
      </p>
      <p>
        They are more efficient than using <code>Statement</code> objects
        because the SQL is pre-compiled and the parameters are bound to the
        statement.
      </p>
      <p>They also help prevent SQL injection attacks.</p>
      <h2 id="example">Example</h2>
      <p>We will refer to this example throughout these notes:</p>
      <pre
        class="shiki shiki-themes one-light one-dark-pro"
        style="
          background-color: #fafafa;
          --shiki-dark-bg: #282c34;
          color: #383a42;
          --shiki-dark: #abb2bf;
        "
        tabindex="0"
      ><code><span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">-- Create a users table</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">CREATE</span><span style="color:#A626A4;--shiki-dark:#C678DD"> TABLE</span><span style="color:#4078F2;--shiki-dark:#61AFEF"> User</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    id </span><span style="color:#A626A4;--shiki-dark:#C678DD">INTEGER</span><span style="color:#A626A4;--shiki-dark:#C678DD"> PRIMARY KEY</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> AUTOINCREMENT,</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    first_name </span><span style="color:#A626A4;--shiki-dark:#C678DD">TEXT</span><span style="color:#A626A4;--shiki-dark:#C678DD"> NOT NULL</span><span style="color:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    last_name </span><span style="color:#A626A4;--shiki-dark:#C678DD">TEXT</span><span style="color:#A626A4;--shiki-dark:#C678DD"> NOT NULL</span><span style="color:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    username </span><span style="color:#A626A4;--shiki-dark:#C678DD">TEXT</span><span style="color:#A626A4;--shiki-dark:#C678DD"> NOT NULL</span><span style="color:#A626A4;--shiki-dark:#C678DD"> UNIQUE</span><span style="color:#383A42;--shiki-dark:#ABB2BF">,</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    password</span><span style="color:#A626A4;--shiki-dark:#C678DD"> TEXT</span><span style="color:#A626A4;--shiki-dark:#C678DD"> NOT NULL</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">-- Insert sample data</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">-- Note: We should never actually store passwords in plain text like this.</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">INSERT INTO</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> User (first_name, last_name, username, </span><span style="color:#A626A4;--shiki-dark:#C678DD">password</span><span style="color:#383A42;--shiki-dark:#ABB2BF">) </span><span style="color:#A626A4;--shiki-dark:#C678DD">VALUES</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'admin'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'admin'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'admin'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'supersecretAdminPass'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">), </span><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">-- This is first so that when we hack in we get to the admin account</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Donny'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Dummikins'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'user'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'pass'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">), </span><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">-- Easy login demo user</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'John'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Smith'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'jsmith'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'password123'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Jane'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Doe'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'jdoe'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'securepass456'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Robert'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Johnson'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'rjohnson'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'robert2024'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Emily'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Williams'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'ewilliams'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'emily1234'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Michael'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Brown'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'mbrown'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'brownmike789'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Sarah'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Davis'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'sdavis'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'davis2023!'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'David'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Miller'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'dmiller'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'millertime55'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Jennifer'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Wilson'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'jwilson'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'jenny9876'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'William'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Taylor'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'wtaylor'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'taylor2022'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    (</span><span style="color:#50A14F;--shiki-dark:#98C379">'Amanda'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'Anderson'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'aanderson'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#50A14F;--shiki-dark:#98C379">'amanda4321'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">);</span></span></code></pre>
      <h2 id="sql-injection">SQL Injection</h2>
      <p>
        <strong>SQL injection</strong> is a technique used to attack databases
        by manipulating the SQL code that is executed.
      </p>
      <p>
        For example, if we have a login page that takes a username and password,
        and we use the following SQL statement:
      </p>
      <pre
        class="shiki shiki-themes one-light one-dark-pro"
        style="
          background-color: #fafafa;
          --shiki-dark-bg: #282c34;
          color: #383a42;
          --shiki-dark: #abb2bf;
        "
        tabindex="0"
      ><code><span class="line"><span style="color:#C18401;--shiki-dark:#E5C07B">String</span><span style="color:#E45649;--shiki-dark:#E06C75"> query </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379"> "SELECT id FROM User WHERE username='"</span><span style="color:#383A42;--shiki-dark:#56B6C2"> +</span><span style="color:#383A42;--shiki-dark:#E06C75"> username </span><span style="color:#383A42;--shiki-dark:#56B6C2">+</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#98C379">        "' AND password='"</span><span style="color:#383A42;--shiki-dark:#56B6C2"> +</span><span style="color:#383A42;--shiki-dark:#E06C75"> password </span><span style="color:#383A42;--shiki-dark:#56B6C2">+</span><span style="color:#50A14F;--shiki-dark:#98C379"> "'"</span><span style="color:#383A42;--shiki-dark:#ABB2BF">;</span></span></code></pre>
      <p>
        If the username is <code>&#39; OR &#39;1&#39;=&#39;1</code> and the
        password is <code>&#39; OR &#39;1&#39;=&#39;1</code>, the SQL statement
        will return all users in the database.
      </p>
      <p>This is because the SQL statement is interpreted as:</p>
      <pre
        class="shiki shiki-themes one-light one-dark-pro"
        style="
          background-color: #fafafa;
          --shiki-dark-bg: #282c34;
          color: #383a42;
          --shiki-dark: #abb2bf;
        "
        tabindex="0"
      ><code><span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">SELECT</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> * </span><span style="color:#A626A4;--shiki-dark:#C678DD">FROM</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> users </span><span style="color:#A626A4;--shiki-dark:#C678DD">WHERE</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> username </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379"> ''</span><span style="color:#A626A4;--shiki-dark:#C678DD"> OR</span><span style="color:#50A14F;--shiki-dark:#98C379"> '1'</span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379">'1'</span><span style="color:#A626A4;--shiki-dark:#C678DD"> AND</span><span style="color:#A626A4;--shiki-dark:#C678DD"> password</span><span style="color:#383A42;--shiki-dark:#56B6C2"> =</span><span style="color:#50A14F;--shiki-dark:#98C379"> ''</span><span style="color:#A626A4;--shiki-dark:#C678DD"> OR</span><span style="color:#50A14F;--shiki-dark:#98C379"> '1'</span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379">'1'</span></span></code></pre>
      <p>
        This is a very simple example, but it can be much more dangerous in real
        applications.
      </p>
      <h2 id="naive-implementation">Naive Implementation</h2>
      <p>
        Below is an unsafe implementation of a login function. A user can inject
        malicious SQL code into the query.
      </p>
      <pre
        class="shiki shiki-themes one-light one-dark-pro"
        style="
          background-color: #fafafa;
          --shiki-dark-bg: #282c34;
          color: #383a42;
          --shiki-dark: #abb2bf;
        "
        tabindex="0"
      ><code><span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// Get username and password from user...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// Interpolate the username and password directly into the query (bad idea)</span></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E5C07B">String</span><span style="color:#E45649;--shiki-dark:#E06C75"> query </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379"> "SELECT * FROM User WHERE username='"</span><span style="color:#383A42;--shiki-dark:#56B6C2"> +</span><span style="color:#383A42;--shiki-dark:#E06C75"> username </span><span style="color:#383A42;--shiki-dark:#56B6C2">+</span></span>
<span class="line"><span style="color:#50A14F;--shiki-dark:#98C379">                "' AND password='"</span><span style="color:#383A42;--shiki-dark:#56B6C2"> +</span><span style="color:#383A42;--shiki-dark:#E06C75"> password </span><span style="color:#383A42;--shiki-dark:#56B6C2">+</span><span style="color:#50A14F;--shiki-dark:#98C379"> "'"</span><span style="color:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E5C07B">System</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#E45649;--shiki-dark:#E5C07B">out</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">println</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#50A14F;--shiki-dark:#98C379">"Generated query: "</span><span style="color:#383A42;--shiki-dark:#56B6C2"> +</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> query);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">try</span><span style="color:#383A42;--shiki-dark:#E06C75"> (</span><span style="color:#C18401;--shiki-dark:#E5C07B">Connection</span><span style="color:#E45649;--shiki-dark:#E06C75"> connection </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#E45649;--shiki-dark:#E5C07B"> DriverManager</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">getConnection</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(JDBC_URL);</span></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E5C07B">        Statement</span><span style="color:#E45649;--shiki-dark:#E06C75"> statement </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#E45649;--shiki-dark:#E5C07B"> connection</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">createStatement</span><span style="color:#383A42;--shiki-dark:#ABB2BF">();</span><span style="color:#383A42;--shiki-dark:#E06C75">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E5C07B">    ResultSet</span><span style="color:#E45649;--shiki-dark:#E06C75"> resultSet </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#E45649;--shiki-dark:#E5C07B"> stmt</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">executeQuery</span><span style="color:#383A42;--shiki-dark:#ABB2BF">()</span><span style="color:#383A42;--shiki-dark:#E06C75">)</span><span style="color:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    if</span><span style="color:#383A42;--shiki-dark:#E06C75"> (</span><span style="color:#E45649;--shiki-dark:#E5C07B">resultSet</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">next</span><span style="color:#383A42;--shiki-dark:#ABB2BF">()</span><span style="color:#383A42;--shiki-dark:#E06C75">) {</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">        return</span><span style="color:#E45649;--shiki-dark:#E5C07B"> resultSet</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">getString</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#50A14F;--shiki-dark:#98C379">"username"</span><span style="color:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">    }</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    else</span><span style="color:#383A42;--shiki-dark:#E06C75"> {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        // Handle invalid credentials...</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">    }</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">} </span><span style="color:#A626A4;--shiki-dark:#C678DD">catch</span><span style="color:#383A42;--shiki-dark:#E06C75"> (</span><span style="color:#C18401;--shiki-dark:#E5C07B">SQLException</span><span style="color:#383A42;font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> ex</span><span style="color:#383A42;--shiki-dark:#E06C75">) {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    // Handle exception...</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
      <h2 id="prepared-statements">Prepared Statements</h2>
      <p>
        Prepared statements are a way to execute SQL statements with parameters.
        These parameters are placeholders that are replaced with actual values
        when the statement is executed.
      </p>
      <p>The main benefits are that:</p>
      <ul>
        <li>
          It is more secure; parameters are not interpolated into the SQL
          string.
        </li>
        <li>
          It is more efficient; the SQL is pre-compiled and the parameters are
          bound to the statement.
        </li>
        <li>
          It handles data type conversion automatically via the &quot;set&quot;
          methods on the <code>PreparedStatement</code> object.
        </li>
        <li>It&#39;s (arguably) easier to read and write.</li>
      </ul>
      <pre
        class="shiki shiki-themes one-light one-dark-pro"
        style="
          background-color: #fafafa;
          --shiki-dark-bg: #282c34;
          color: #383a42;
          --shiki-dark: #abb2bf;
        "
        tabindex="0"
      ><code><span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">// Get username and password from user...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">try</span><span style="color:#383A42;--shiki-dark:#E06C75"> (</span><span style="color:#C18401;--shiki-dark:#E5C07B">Connection</span><span style="color:#E45649;--shiki-dark:#E06C75"> connection </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#E45649;--shiki-dark:#E5C07B"> DriverManager</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">getConnection</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(JDBC_URL);</span></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E5C07B">        PreparedStatement</span><span style="color:#E45649;--shiki-dark:#E06C75"> stmt </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#E45649;--shiki-dark:#E5C07B"> connection</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">prepareStatement</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(query)</span><span style="color:#383A42;--shiki-dark:#E06C75">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E5C07B">    String</span><span style="color:#E45649;--shiki-dark:#E06C75"> query </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379"> "SELECT id FROM User WHERE username = ? AND password = ?"</span><span style="color:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    // Safely set the parameters</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E5C07B">    stmt</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">setString</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#986801;--shiki-dark:#D19A66">1</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, username);</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E5C07B">    stmt</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">setString</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#986801;--shiki-dark:#D19A66">2</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, password);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C18401;--shiki-dark:#E5C07B">    ResultSet</span><span style="color:#E45649;--shiki-dark:#E06C75"> resultSet </span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#E45649;--shiki-dark:#E5C07B"> stmt</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">executeQuery</span><span style="color:#383A42;--shiki-dark:#ABB2BF">()</span><span style="color:#383A42;--shiki-dark:#E06C75">)</span><span style="color:#383A42;--shiki-dark:#ABB2BF">;</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    if</span><span style="color:#383A42;--shiki-dark:#E06C75"> (</span><span style="color:#E45649;--shiki-dark:#E5C07B">resultSet</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">next</span><span style="color:#383A42;--shiki-dark:#ABB2BF">()</span><span style="color:#383A42;--shiki-dark:#E06C75">) {</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">        return</span><span style="color:#E45649;--shiki-dark:#E5C07B"> resultSet</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#4078F2;--shiki-dark:#61AFEF">getString</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#50A14F;--shiki-dark:#98C379">"username"</span><span style="color:#383A42;--shiki-dark:#ABB2BF">);</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">    }</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    else</span><span style="color:#383A42;--shiki-dark:#E06C75"> {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        // Handle invalid credentials...</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">    }</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">} </span><span style="color:#A626A4;--shiki-dark:#C678DD">catch</span><span style="color:#383A42;--shiki-dark:#E06C75"> (</span><span style="color:#C18401;--shiki-dark:#E5C07B">SQLException</span><span style="color:#383A42;font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic"> ex</span><span style="color:#383A42;--shiki-dark:#E06C75">) {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    // Handle exception...</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">}</span></span></code></pre>
    </div>
  </body>
</html>
